<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zipline-Reloaded Documentation</title>
    <style>
        :root {
            --bg-primary: #1a1b26;
            --bg-secondary: #24283b;
            --bg-tertiary: #414868;
            --text-primary: #a9b1d6;
            --text-secondary: #7aa2f7;
            --text-muted: #565f89;
            --accent-blue: #7aa2f7;
            --accent-green: #9ece6a;
            --accent-yellow: #e0af68;
            --accent-red: #f7768e;
            --accent-purple: #bb9af7;
            --accent-cyan: #7dcfff;
            --border-color: #3b4261;
            --code-bg: #1f2335;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Layout */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            padding: 20px 0;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .sidebar-header h1 {
            color: var(--accent-cyan);
            font-size: 1.4em;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            color: var(--text-muted);
            font-size: 0.85em;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-section-title {
            padding: 8px 20px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
        }

        .nav-item {
            display: block;
            padding: 8px 20px;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background-color: var(--bg-tertiary);
            color: var(--accent-blue);
            border-left-color: var(--accent-blue);
        }

        .nav-item.active {
            background-color: var(--bg-tertiary);
            color: var(--accent-cyan);
            border-left-color: var(--accent-cyan);
        }

        .nav-subitem {
            padding-left: 35px;
            font-size: 0.85em;
            color: var(--text-muted);
        }

        .nav-subitem:hover {
            color: var(--text-primary);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 40px 60px;
            max-width: 1200px;
        }

        /* Typography */
        h1, h2, h3, h4 {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        h1 {
            font-size: 2.2em;
            border-bottom: 2px solid var(--accent-cyan);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            font-size: 1.6em;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        h3 {
            font-size: 1.3em;
            color: var(--accent-green);
            margin-top: 25px;
        }

        h4 {
            font-size: 1.1em;
            color: var(--accent-yellow);
        }

        p {
            margin-bottom: 15px;
        }

        /* Section containers */
        .section {
            margin-bottom: 60px;
            scroll-margin-top: 20px;
        }

        /* Code blocks */
        pre {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85em;
            line-height: 1.5;
        }

        code {
            background-color: var(--code-bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            color: var(--accent-cyan);
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text-primary);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9em;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background-color: var(--bg-secondary);
            color: var(--accent-blue);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--bg-secondary);
        }

        /* Lists */
        ul, ol {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin-bottom: 8px;
        }

        /* Links */
        a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
            color: var(--accent-cyan);
        }

        /* Callouts */
        .callout {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .callout-info {
            background-color: rgba(122, 162, 247, 0.1);
            border-left-color: var(--accent-blue);
        }

        .callout-warning {
            background-color: rgba(224, 175, 104, 0.1);
            border-left-color: var(--accent-yellow);
        }

        .callout-success {
            background-color: rgba(158, 206, 106, 0.1);
            border-left-color: var(--accent-green);
        }

        .callout-danger {
            background-color: rgba(247, 118, 142, 0.1);
            border-left-color: var(--accent-red);
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-time {
            background-color: var(--accent-purple);
            color: var(--bg-primary);
        }

        /* Feature cards */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }

        .feature-card h4 {
            margin-bottom: 10px;
        }

        /* Top button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--accent-blue);
            color: var(--bg-primary);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 1.2em;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .back-to-top.visible {
            opacity: 1;
        }

        .back-to-top:hover {
            background-color: var(--accent-cyan);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 240px;
            }
            .main-content {
                margin-left: 240px;
                padding: 30px 40px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
                z-index: 1000;
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }

        /* Command reference styling */
        .command-block {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .command-block .comment {
            color: var(--text-muted);
        }

        .command-block .command {
            color: var(--accent-green);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>Zipline-Reloaded</h1>
                <p>Documentation v1.0</p>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Getting Started</div>
                <a href="#overview" class="nav-item">Overview</a>
                <a href="#quick-start" class="nav-item">Quick Start</a>
                <a href="#installation" class="nav-item">Installation</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Data Management</div>
                <a href="#data-setup" class="nav-item">Initial Setup</a>
                <a href="#daily-updates" class="nav-item">Daily Updates</a>
                <a href="#bundle-cleanup" class="nav-item">Bundle Cleanup</a>
                <a href="#alternative-bundles" class="nav-item">Alternative Bundles</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Fundamentals</div>
                <a href="#sharadar-fundamentals" class="nav-item">Sharadar Fundamentals</a>
                <a href="#pipeline-usage" class="nav-item">Pipeline Usage</a>
                <a href="#available-metrics" class="nav-item">Available Metrics</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Multi-Source Data</div>
                <a href="#multi-source-overview" class="nav-item">Overview</a>
                <a href="#custom-databases" class="nav-item">Custom Databases</a>
                <a href="#auto-loader" class="nav-item">AutoLoader</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Symbol Mapping</div>
                <a href="#symbol-changes" class="nav-item">Symbol Changes</a>
                <a href="#temporal-mapping" class="nav-item">Temporal Mapping</a>
                <a href="#auto-mapper" class="nav-item">Auto Mapper</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Monitoring</div>
                <a href="#flightlog" class="nav-item">FlightLog</a>
                <a href="#log-levels" class="nav-item">Log Levels</a>
                <a href="#best-practices" class="nav-item">Best Practices</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Development</div>
                <a href="#docker-setup" class="nav-item">Docker Setup</a>
                <a href="#build-optimization" class="nav-item">Build Optimization</a>
                <a href="#troubleshooting" class="nav-item">Troubleshooting</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Reference</div>
                <a href="#command-reference" class="nav-item">Command Reference</a>
                <a href="#resource-requirements" class="nav-item">Resources</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview -->
            <section id="overview" class="section">
                <h1>Zipline-Reloaded Documentation</h1>
                <p>Complete guide for using Zipline-Reloaded with Sharadar data, multi-source fundamentals, FlightLog monitoring, and backtesting.</p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>ðŸ“Š Sharadar Data</h4>
                        <p>Premium institutional-grade market data with point-in-time accuracy and 150+ fundamental metrics.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ”„ Incremental Updates</h4>
                        <p>Daily updates in 30 seconds instead of re-downloading everything.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“¡ FlightLog</h4>
                        <p>Real-time log streaming with color-coded levels and progress monitoring.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ”— Multi-Source</h4>
                        <p>Combine Sharadar with custom databases (LSEG, etc.) in a single pipeline.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Start -->
            <section id="quick-start" class="section">
                <h2>Quick Start <span class="badge badge-time">5 min</span></h2>
                
                <h3>1. Get API Key</h3>
                <ol>
                    <li>Subscribe at: <a href="https://data.nasdaq.com/databases/SFA">data.nasdaq.com/databases/SFA</a></li>
                    <li>Copy your API key from Account Settings</li>
                </ol>

                <h3>2. Configure Key</h3>
                <pre><code># Create .env file
cd /path/to/zipline-reloaded
echo 'NASDAQ_DATA_LINK_API_KEY=your-key-here' > .env</code></pre>

                <h3>3. Initial Download</h3>
                <pre><code># Start container
docker compose up -d

# Download all historical data (takes 10-20 minutes)
docker compose exec zipline-jupyter zipline ingest -b sharadar</code></pre>

                <div class="callout callout-info">
                    <strong>Expected:</strong> Time: 10-20 minutes | Storage: ~10 GB | Date range: 1998 to today | Tickers: ~8,000
                </div>

                <h3>4. Daily Updates</h3>
                <pre><code># Run after market close (6 PM ET or later)
docker compose exec zipline-jupyter zipline ingest -b sharadar</code></pre>
                <p>Takes only <strong>10-30 seconds</strong> (incremental updates)!</p>
            </section>

            <!-- Installation -->
            <section id="installation" class="section">
                <h2>Installation</h2>
                
                <h3>Prerequisites</h3>
                <ul>
                    <li>Docker and Docker Compose</li>
                    <li>NASDAQ Data Link API key (Sharadar subscription)</li>
                    <li>16 GB RAM (for initial ingestion)</li>
                    <li>20 GB free disk space</li>
                </ul>

                <h3>Clone and Setup</h3>
                <pre><code>git clone https://github.com/ksokhanvari/zipline-reloaded.git
cd zipline-reloaded

# Configure API key
echo 'NASDAQ_DATA_LINK_API_KEY=your-key' > .env

# Build and start
docker compose build
docker compose up -d</code></pre>
            </section>

            <!-- Data Setup -->
            <section id="data-setup" class="section">
                <h2>Initial Data Setup</h2>

                <h3>Why Sharadar?</h3>
                <table>
                    <tr>
                        <th>Feature</th>
                        <th>Sharadar</th>
                        <th>Yahoo Finance</th>
                    </tr>
                    <tr>
                        <td>Data Quality</td>
                        <td>Institutional-grade</td>
                        <td>Good</td>
                    </tr>
                    <tr>
                        <td>Point-in-Time</td>
                        <td>Yes</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Corporate Actions</td>
                        <td>Comprehensive</td>
                        <td>Basic</td>
                    </tr>
                    <tr>
                        <td>Historical Depth</td>
                        <td>Complete (1998+)</td>
                        <td>~20 years</td>
                    </tr>
                    <tr>
                        <td>Cost</td>
                        <td>Paid subscription</td>
                        <td>Free</td>
                    </tr>
                </table>

                <h3>Verify Data</h3>
                <pre><code># Check ingestion status
docker compose exec zipline-jupyter zipline bundles

# Check in Python
from zipline.data import bundles
bundle = bundles.load('sharadar')
sessions = bundle.equity_daily_bar_reader.sessions
print(f"First: {sessions[0].date()}, Last: {sessions[-1].date()}")</code></pre>
            </section>

            <!-- Daily Updates -->
            <section id="daily-updates" class="section">
                <h2>Daily Updates</h2>

                <h3>When to Run</h3>
                <table>
                    <tr>
                        <th>Time (ET)</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                    <tr>
                        <td>Before 5:00 PM</td>
                        <td>Data not ready</td>
                        <td>Don't run yet</td>
                    </tr>
                    <tr>
                        <td>5:00-6:00 PM</td>
                        <td>Processing</td>
                        <td>May be incomplete</td>
                    </tr>
                    <tr>
                        <td>After 6:00 PM</td>
                        <td>Ready</td>
                        <td>Safe to run</td>
                    </tr>
                </table>

                <h3>Automation with Cron</h3>
                <pre><code># Edit crontab
crontab -e

# Add line (runs Mon-Fri at 6 PM ET)
0 18 * * 1-5 cd /path/to/zipline-reloaded && \
    docker compose exec -T zipline-jupyter zipline ingest -b sharadar \
    >> /var/log/sharadar-update.log 2>&1</code></pre>
            </section>

            <!-- Bundle Cleanup -->
            <section id="bundle-cleanup" class="section">
                <h2>Bundle Cleanup</h2>

                <p>Each ingestion creates a new timestamped directory. Cleanup saves disk space.</p>

                <pre><code># Keep only the 2 most recent ingestions
docker exec zipline-reloaded-jupyter zipline clean -b sharadar --keep-last 2

# Keep only the most recent
docker exec zipline-reloaded-jupyter zipline clean -b sharadar --keep-last 1</code></pre>

                <h3>Recommended Keep Count</h3>
                <table>
                    <tr>
                        <th>Scenario</th>
                        <th>Keep Last</th>
                        <th>Disk Usage</th>
                    </tr>
                    <tr>
                        <td>Development</td>
                        <td>1-2</td>
                        <td>~1.2 GB</td>
                    </tr>
                    <tr>
                        <td>Production</td>
                        <td>2-3</td>
                        <td>~1.8 GB</td>
                    </tr>
                    <tr>
                        <td>Critical</td>
                        <td>5-7</td>
                        <td>~4.2 GB</td>
                    </tr>
                </table>
            </section>

            <!-- Alternative Bundles -->
            <section id="alternative-bundles" class="section">
                <h2>Alternative Bundles</h2>

                <h3>Tech Stocks Only (Fast Testing)</h3>
                <pre><code># Takes 30 seconds instead of 20 minutes
docker exec zipline-reloaded-jupyter zipline ingest -b sharadar-tech

# Includes: AAPL, MSFT, GOOGL, AMZN, META, NVDA, TSLA, NFLX, etc.</code></pre>

                <h3>Custom Ticker List</h3>
                <pre><code># Edit ~/.zipline/extension.py
from zipline.data.bundles import register
from zipline.data.bundles.sharadar_bundle import sharadar_bundle

register('my-stocks', sharadar_bundle(
    tickers=['SPY', 'QQQ', 'AAPL', 'MSFT', 'TSLA'],
    incremental=True,
))</code></pre>
            </section>

            <!-- Sharadar Fundamentals -->
            <section id="sharadar-fundamentals" class="section">
                <h2>Sharadar Fundamentals <span class="badge badge-time">20 min</span></h2>

                <p>Access 150+ quarterly fundamental metrics from Sharadar's SF1 table through Zipline's Pipeline API.</p>

                <h3>Key Features</h3>
                <ul>
                    <li><strong>Point-in-Time Correct</strong>: Uses filing dates to prevent look-ahead bias</li>
                    <li><strong>150+ Metrics</strong>: Revenue, earnings, ratios, cash flow, and more</li>
                    <li><strong>Automatic Forward-Filling</strong>: Quarterly data persists until next quarter</li>
                    <li><strong>Pipeline Integration</strong>: Works with Zipline's factor library</li>
                </ul>

                <h3>Basic Usage</h3>
                <pre><code>from zipline.pipeline import Pipeline
from zipline.pipeline.data.sharadar import SharadarFundamentals

pipeline = Pipeline(
    columns={
        'revenue': SharadarFundamentals.revenue.latest,
        'net_income': SharadarFundamentals.netinc.latest,
        'roe': SharadarFundamentals.roe.latest,
        'pe_ratio': SharadarFundamentals.pe.latest,
    }
)</code></pre>
            </section>

            <!-- Pipeline Usage -->
            <section id="pipeline-usage" class="section">
                <h2>Pipeline Usage</h2>

                <h3>Screening</h3>
                <pre><code>from zipline.pipeline.data.sharadar import SharadarFundamentals

# Value screen
value_screen = (
    (SharadarFundamentals.pe.latest < 15) &
    (SharadarFundamentals.pb.latest < 2) &
    (SharadarFundamentals.dps.latest > 1.0)
)

# Quality screen
quality_screen = (
    (SharadarFundamentals.roe.latest > 15) &
    (SharadarFundamentals.de.latest < 1.0) &
    (SharadarFundamentals.currentratio.latest > 1.5)
)

pipeline = Pipeline(
    columns={
        'pe': SharadarFundamentals.pe.latest,
        'roe': SharadarFundamentals.roe.latest,
    },
    screen=value_screen | quality_screen,
)</code></pre>
            </section>

            <!-- Available Metrics -->
            <section id="available-metrics" class="section">
                <h2>Available Metrics</h2>

                <h3>Income Statement</h3>
                <table>
                    <tr><th>Metric</th><th>Column</th><th>Description</th></tr>
                    <tr><td>Revenue</td><td><code>revenue</code></td><td>Total revenue</td></tr>
                    <tr><td>Net Income</td><td><code>netinc</code></td><td>Bottom-line profit</td></tr>
                    <tr><td>EBITDA</td><td><code>ebitda</code></td><td>Earnings before interest, taxes, depreciation</td></tr>
                    <tr><td>Gross Profit</td><td><code>grossprofit</code></td><td>Revenue minus cost</td></tr>
                </table>

                <h3>Ratios</h3>
                <table>
                    <tr><th>Metric</th><th>Column</th><th>Description</th></tr>
                    <tr><td>ROE</td><td><code>roe</code></td><td>Return on equity (%)</td></tr>
                    <tr><td>P/E Ratio</td><td><code>pe</code></td><td>Price to earnings</td></tr>
                    <tr><td>P/B Ratio</td><td><code>pb</code></td><td>Price to book</td></tr>
                    <tr><td>Debt/Equity</td><td><code>de</code></td><td>Debt to equity ratio</td></tr>
                </table>

                <h3>Per-Share Metrics</h3>
                <table>
                    <tr><th>Metric</th><th>Column</th><th>Description</th></tr>
                    <tr><td>EPS</td><td><code>eps</code></td><td>Earnings per share</td></tr>
                    <tr><td>Book Value</td><td><code>bvps</code></td><td>Book value per share</td></tr>
                    <tr><td>FCF per Share</td><td><code>fcfps</code></td><td>Free cash flow per share</td></tr>
                    <tr><td>Dividends</td><td><code>dps</code></td><td>Dividends per share</td></tr>
                </table>
            </section>

            <!-- Multi-Source Overview -->
            <section id="multi-source-overview" class="section">
                <h2>Multi-Source Data <span class="badge badge-time">15 min</span></h2>

                <p>A simple, clean architecture for combining multiple fundamental data sources (Sharadar, LSEG, custom databases) in Zipline backtests.</p>

                <h3>One-Line Import</h3>
                <pre><code>from zipline.pipeline import multi_source as ms

# Available components:
# ms.Pipeline - Pipeline class
# ms.Database - Custom database base class
# ms.Column - Column definition
# ms.sharadar - Sharadar datasets
# ms.setup_auto_loader() - Automatic loader setup</code></pre>

                <h3>Three-Step Pattern</h3>
                <pre><code># 1. Define Custom Database
class CustomFundamentals(ms.Database):
    CODE = "fundamentals"  # Must match SQLite filename
    LOOKBACK_WINDOW = 252
    ROE = ms.Column(float)
    PEG = ms.Column(float)

# 2. Create Pipeline mixing sources
def make_pipeline():
    s_fcf = ms.SharadarFundamentals.fcf.latest
    c_roe = CustomFundamentals.ROE.latest
    
    return ms.Pipeline(
        columns={'s_fcf': s_fcf, 'c_roe': c_roe},
        screen=(s_fcf > 0) & (c_roe > 15),
    )

# 3. Run Backtest
results = run_algorithm(
    ...,
    custom_loader=ms.setup_auto_loader(),  # Magic!
)</code></pre>
            </section>

            <!-- Custom Databases -->
            <section id="custom-databases" class="section">
                <h2>Custom Databases</h2>

                <h3>Database Schema</h3>
                <pre><code>CREATE TABLE Price (
    Date TEXT NOT NULL,      -- YYYY-MM-DD format
    Sid INTEGER NOT NULL,    -- Use bundle SIDs
    ROE REAL,
    PEG REAL,
    PRIMARY KEY (Date, Sid)
);

CREATE INDEX idx_date ON Price(Date);
CREATE INDEX idx_sid ON Price(Sid);</code></pre>

                <h3>Database Location</h3>
                <pre><code>~/.zipline/data/custom/{CODE}.sqlite

# Example: CODE = "fundamentals"
# Location: ~/.zipline/data/custom/fundamentals.sqlite</code></pre>

                <h3>Column Types</h3>
                <pre><code>Revenue = ms.Column(float)   # Numeric data
Count = ms.Column(int)       # Integer data
Sector = ms.Column(object)   # Text data</code></pre>
            </section>

            <!-- AutoLoader -->
            <section id="auto-loader" class="section">
                <h2>AutoLoader</h2>

                <p>The AutoLoader automatically detects and routes columns to the appropriate data source.</p>

                <h3>Configuration Options</h3>
                <pre><code># Custom database directory
loader = ms.setup_auto_loader(
    custom_db_dir='/path/to/databases',
)

# Different bundle
loader = ms.setup_auto_loader(
    bundle_name='my_bundle',
)

# Disable SID translation
loader = ms.setup_auto_loader(
    enable_sid_translation=False,
)</code></pre>
            </section>

            <!-- Symbol Changes -->
            <section id="symbol-changes" class="section">
                <h2>Symbol Changes <span class="badge badge-time">10 min</span></h2>

                <p>When companies change ticker symbols (like FB â†’ META), naive mapping creates discontinuous data.</p>

                <h3>The Problem</h3>
                <pre><code># Wrong approach:
FB rows (2012-2021)   â†’ SID 644713
META rows (2022-2025) â†’ SID 194817

# Result: Two separate securities, broken continuity</code></pre>

                <h3>The Solution</h3>
                <p>Use temporal lookups to get the correct SID for each row's date:</p>
                <pre><code>asset = asset_finder.lookup_symbol('FB', as_of_date='2020-01-01')
# Returns: SID 194817 (Meta/Facebook)

asset = asset_finder.lookup_symbol('META', as_of_date='2023-01-01')
# Returns: SID 194817 (same company!)</code></pre>
            </section>

            <!-- Temporal Mapping -->
            <section id="temporal-mapping" class="section">
                <h2>Temporal SID Mapping</h2>

                <pre><code>from temporal_sid_mapper import TemporalSIDMapper

# Initialize with asset finder
mapper = TemporalSIDMapper(asset_finder)

# Map dataframe automatically
custom_data['Sid'] = mapper.map_dataframe_auto(
    custom_data,
    symbol_col='Symbol',
    date_col='Date',
    verbose=True
)</code></pre>

                <h3>What It Handles</h3>
                <ul>
                    <li><strong>FB â†’ META</strong> (Facebook rebranded)</li>
                    <li><strong>GOOG â†’ GOOGL</strong> (Google ticker changes)</li>
                    <li>Mergers and acquisitions</li>
                    <li>Spin-offs</li>
                    <li>Any temporal symbol change in Zipline's database</li>
                </ul>
            </section>

            <!-- Auto Mapper -->
            <section id="auto-mapper" class="section">
                <h2>Auto Symbol Mapper</h2>

                <p>For symbols not in the bundle, use intelligent fuzzy matching based on company names.</p>

                <pre><code>from symbol_mapper_auto import AutoSymbolMapper

auto_mapper = AutoSymbolMapper(asset_finder)

custom_data = auto_mapper.auto_learn_and_map(
    custom_data,
    symbol_col='Symbol',
    name_col='CompanyCommonName',
    auto_threshold=0.85,
    verbose=True
)</code></pre>

                <h3>Confidence Scoring</h3>
                <ul>
                    <li><strong>â‰¥0.85</strong>: Auto-apply (high confidence)</li>
                    <li><strong>0.70-0.85</strong>: Manual review</li>
                    <li><strong>&lt;0.70</strong>: Skip (no good match)</li>
                </ul>

                <h3>Mapping File Location</h3>
                <code>/root/.zipline/data/custom/symbol_mappings.json</code>
            </section>

            <!-- FlightLog -->
            <section id="flightlog" class="section">
                <h2>FlightLog <span class="badge badge-time">10 min</span></h2>

                <p>Real-time log streaming system that displays backtest logs in a separate terminal.</p>

                <h3>Start FlightLog</h3>
                <pre><code># Start in foreground (shows colors)
docker compose run --rm flightlog

# Or in background
docker compose up -d flightlog</code></pre>

                <h3>Enable in Strategy</h3>
                <pre><code>import logging
from zipline.utils.flightlog_client import enable_flightlog, log_to_flightlog
from zipline.utils.progress import enable_progress_logging

logging.basicConfig(level=logging.INFO, force=True)
enable_flightlog(host='localhost', port=9020)
enable_progress_logging(algo_name='My-Strategy', update_interval=5)

# Log events
log_to_flightlog('Strategy initialized', level='INFO')
log_to_flightlog('Portfolio rebalanced', level='INFO')</code></pre>
            </section>

            <!-- Log Levels -->
            <section id="log-levels" class="section">
                <h2>Log Levels</h2>

                <table>
                    <tr>
                        <th>Level</th>
                        <th>Color</th>
                        <th>When to Use</th>
                    </tr>
                    <tr>
                        <td>DEBUG</td>
                        <td style="color: var(--accent-cyan);">Cyan</td>
                        <td>Detailed debugging</td>
                    </tr>
                    <tr>
                        <td>INFO</td>
                        <td style="color: var(--accent-green);">Green</td>
                        <td>Normal operations</td>
                    </tr>
                    <tr>
                        <td>WARNING</td>
                        <td style="color: var(--accent-yellow);">Yellow</td>
                        <td>Unusual conditions</td>
                    </tr>
                    <tr>
                        <td>ERROR</td>
                        <td style="color: var(--accent-red);">Red</td>
                        <td>Failures</td>
                    </tr>
                    <tr>
                        <td>CRITICAL</td>
                        <td style="color: var(--accent-purple);">Magenta</td>
                        <td>Critical issues</td>
                    </tr>
                </table>
            </section>

            <!-- Best Practices -->
            <section id="best-practices" class="section">
                <h2>Logging Best Practices</h2>

                <h3>Do</h3>
                <ul>
                    <li>Log strategic events (trades, rebalances)</li>
                    <li>Include context in messages</li>
                    <li>Log summary metrics at end</li>
                </ul>

                <h3>Don't</h3>
                <ul>
                    <li>Log on every bar (too noisy)</li>
                    <li>Duplicate progress information</li>
                    <li>Log sensitive information (API keys)</li>
                </ul>

                <h3>Update Intervals</h3>
                <pre><code># Short backtests (< 1 year)
enable_progress_logging(update_interval=1)  # Daily

# Medium backtests (1-5 years)
enable_progress_logging(update_interval=5)  # Weekly

# Long backtests (5+ years)
enable_progress_logging(update_interval=20)  # Monthly</code></pre>
            </section>

            <!-- Docker Setup -->
            <section id="docker-setup" class="section">
                <h2>Docker Setup</h2>

                <h3>Volume Mounts</h3>
                <pre><code>volumes:
  - ./data:/data                    # Strategy output
  - zipline-data:/root/.zipline     # Bundles
  - pip-cache:/root/.cache/pip      # Package cache</code></pre>

                <h3>When to Rebuild vs Restart</h3>
                <table>
                    <tr>
                        <th>Change Type</th>
                        <th>Action</th>
                    </tr>
                    <tr>
                        <td>Python source code</td>
                        <td>Rebuild container</td>
                    </tr>
                    <tr>
                        <td>Requirements/dependencies</td>
                        <td>Rebuild container</td>
                    </tr>
                    <tr>
                        <td>Strategy code (mounted)</td>
                        <td>Restart container</td>
                    </tr>
                    <tr>
                        <td>Data files</td>
                        <td>Restart container</td>
                    </tr>
                </table>
            </section>

            <!-- Build Optimization -->
            <section id="build-optimization" class="section">
                <h2>Build Optimization</h2>

                <h3>Enable BuildKit</h3>
                <pre><code># Run setup script
./scripts/setup-buildkit.sh

# Reload shell config
source ~/.zshrc  # Mac
source ~/.bashrc  # Linux</code></pre>

                <h3>Build Performance</h3>
                <table>
                    <tr>
                        <th>Scenario</th>
                        <th>Without Caching</th>
                        <th>With Caching</th>
                    </tr>
                    <tr>
                        <td>Clean build</td>
                        <td>15-20 min</td>
                        <td>15-20 min</td>
                    </tr>
                    <tr>
                        <td>Rebuild (no changes)</td>
                        <td>15-20 min</td>
                        <td>2-3 min</td>
                    </tr>
                    <tr>
                        <td>Rebuild (code only)</td>
                        <td>15-20 min</td>
                        <td>2-3 min</td>
                    </tr>
                </table>
            </section>

            <!-- Troubleshooting -->
            <section id="troubleshooting" class="section">
                <h2>Troubleshooting</h2>

                <h3>API Key Issues</h3>
                <pre><code># Check .env file
cat .env

# If missing
echo 'NASDAQ_DATA_LINK_API_KEY=your-key' > .env
docker compose restart</code></pre>

                <h3>Out of Memory</h3>
                <p>Increase Docker memory to <strong>16 GB</strong> for initial ingestion.</p>
                <p>Docker Desktop â†’ Settings â†’ Resources â†’ Memory</p>

                <h3>FlightLog Not Connecting</h3>
                <pre><code># Check if running
docker ps | grep flightlog

# Test connection
import socket
sock = socket.socket()
result = sock.connect_ex(('localhost', 9020))
print("Open" if result == 0 else "Closed")</code></pre>

                <h3>No Data for Today</h3>
                <p>Wait 1-2 hours after market close (safe after 6 PM ET).</p>
            </section>

            <!-- Command Reference -->
            <section id="command-reference" class="section">
                <h2>Command Reference</h2>

                <h3>Data Management</h3>
                <pre><code># List bundles
zipline bundles

# Ingest/update data
zipline ingest -b sharadar

# Clean old ingestions
zipline clean -b sharadar --keep-last 2</code></pre>

                <h3>FlightLog</h3>
                <pre><code># Start FlightLog
docker compose run --rm flightlog

# Filter progress bars
docker compose run --rm flightlog python /app/scripts/flightlog.py --filter-progress</code></pre>

                <h3>Docker</h3>
                <pre><code># Start services
docker compose up -d

# Rebuild image
docker compose build zipline-jupyter

# Restart container
docker compose restart zipline-jupyter

# View logs
docker compose logs zipline-jupyter</code></pre>
            </section>

            <!-- Resource Requirements -->
            <section id="resource-requirements" class="section">
                <h2>Resource Requirements</h2>

                <table>
                    <tr>
                        <th>Operation</th>
                        <th>Time</th>
                        <th>Storage</th>
                        <th>RAM</th>
                    </tr>
                    <tr>
                        <td>Initial download</td>
                        <td>60-90 min</td>
                        <td>10-15 GB</td>
                        <td>16 GB</td>
                    </tr>
                    <tr>
                        <td>Daily update</td>
                        <td>2-5 min</td>
                        <td>+50-100 MB</td>
                        <td>4 GB</td>
                    </tr>
                    <tr>
                        <td>Tech bundle</td>
                        <td>30 sec</td>
                        <td>50 MB</td>
                        <td>2 GB</td>
                    </tr>
                </table>
            </section>

            <!-- Footer -->
            <footer style="margin-top: 60px; padding-top: 30px; border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9em;">
                <p><strong>Last Updated:</strong> 2025-11-19</p>
                <p><strong>Source Files:</strong> Individual markdown files in <code>docs/</code> directory</p>
                <p><strong>License:</strong> Apache 2.0</p>
            </footer>
        </main>
    </div>

    <!-- Back to top button -->
    <a href="#overview" class="back-to-top" id="backToTop">â†‘</a>

    <script>
        // Back to top button visibility
        const backToTop = document.getElementById('backToTop');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTop.classList.add('visible');
            } else {
                backToTop.classList.remove('visible');
            }
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('.nav-item').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const target = document.getElementById(targetId);
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
                
                // Update active state
                document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                link.classList.add('active');
            });
        });

        // Update active nav on scroll
        const sections = document.querySelectorAll('.section');
        const navItems = document.querySelectorAll('.nav-item');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) {
                    item.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
